FROM fedora:26
ARG user
ARG uid
ARG gid
LABEL maintainer=curtissand@gmail.com

RUN dnf upgrade -y
RUN dnf install -y git

RUN grep ":$gid:" /etc/group || groupadd $user -g $gid
RUN useradd --uid $uid --gid $gid $user --password $user
RUN chown -R $uid:$gid /opt

USER $user:$gid
RUN /usr/bin/python3 -m venv /opt/escadrille_env
RUN /opt/escadrille_env/bin/pip install git+https://git@github.com/fretboardfreak/escadrille.git
RUN echo "export PATH=\"\$PATH:/opt/escadrille_env/bin\"" >> /home/$user/.bashrc

WORKDIR /home/$user
